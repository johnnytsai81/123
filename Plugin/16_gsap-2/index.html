<!DOCTYPE html><html lang="zh-TW"><head><meta charset="UTF-8"><title>用GSAP製作網站特效（二）ScrollTrigger</title><meta name="description" content="Website / UI Designer"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><meta name="google-site-verification" content="csMqM_jSDHR5JB6bx5sbYtDim3pnfXztxvWKHSykzRA"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/style/common/base.css"><link rel="stylesheet" href="/style/common/common.css"><link rel="stylesheet" href="/style/app.css"><script src="/jquery/jquery.min.js"></script><script src="/jquery/inview.min.js"></script><script src="/jquery/swiper/js/swiper.min.js"></script><script defer src="/js/clipboard.min.js"></script><script defer src="/js/custom.js"></script><script defer src="/js/webfont.js"></script><link rel="stylesheet" href="/style/post.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="ScrollTrigger是利用滑鼠滾動來控制動畫的套件，最大的賣點之一是他可以做出pin的效果，你可以自由控制什麼時候要被pin住。

ScrollTrigger 的基礎操作ScrollTrigger是利用滑鼠滾動來控制動畫的套件，最大的賣點之一是他可以做出pin的效果，你可以自由控制什麼時候要被pin住。他的原理是fixed住你想pin的區塊並且加入padding-bottom把下方的區塊推下去，讓使用者在感覺不出來畫面是有真實在滾動的。
step 1. 載入套件第一步你要先告訴gsap你要加載這個套件跟你要控制的物件
gsap.registerPlugin(ScrollTrigger);// trigger代表你想要作用的區塊(如果不寫的話會自動抓gsap.to的對象，所以也可以省略)gsap.to(.."><meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/atom.xml" title="Anthony's Blog" type="application/atom+xml">
</head><body><header><div id="loading"><img id="loading-image" src="/images/loading-logo.png" alt="Loading..."><div class="loader"></div></div><div class="loading-easein"></div><div class="loading-background"></div><nav class="hidden lg:flex items-center justify-between flex-wrap py-6 px-8"><div class="flex items-center flex-shrink-0"><a href="/"> <svg class="header-logo" alt="Logo" xmlns="http://www.w3.org/2000/svg" height="30" width="70" viewbox="0 0 70 30"><path class="logo-text" d="M39.88.24l7.19,29.52H38.89l-.79-5.17H32l-.78,5.17H23.14L30.21.24ZM35,6.28,32.89,18.8h4.3L35.09,6.28Z" fill="#1860c3"/><path class="logo-leaf" d="M20.14,15.09A14.38,14.38,0,0,0,5.76.71,14.38,14.38,0,0,0,20.14,15.09Z" fill="#ffbf6b"/><path class="logo-leaf" d="M20.14,15.09A14.38,14.38,0,0,0,5.76,29.47,14.38,14.38,0,0,0,20.14,15.09Z" fill="#ffbf6b"/><circle class="logo-dot" cx="5.76" cy="15.09" r="2.56" fill="#1860c3"/><path class="logo-leaf" d="M49.86,15.09A14.38,14.38,0,0,0,64.24,29.47,14.38,14.38,0,0,0,49.86,15.09Z" fill="#ffbf6b"/><path class="logo-leaf" d="M49.86,15.09A14.38,14.38,0,0,0,64.24.71,14.38,14.38,0,0,0,49.86,15.09Z" fill="#ffbf6b"/><circle class="logo-dot" cx="64.24" cy="15.09" r="2.56" fill="#1860c3"/></svg></a></div><div class="block lg:flex lg:items-center lg:w-auto"><div class="lg:flex-grow"><a class="nav-title line-hover" href="/"> <span>Home</span></a><a class="nav-title line-hover" href="/work"><span>Work</span></a><a class="nav-title line-hover" href="/blog"><span>Blog</span></a></div></div></nav><nav class="relative header-widget flex-shrink-0 self-center justify-between flex py-4 px-6 lg:hidden z-50"><div class="flex items-center flex-shrink-0"><a href="/"> <svg class="header-logo" xmlns="http://www.w3.org/2000/svg" height="30" width="70" viewbox="0 0 70 30"><path class="logo-text" d="M39.88.24l7.19,29.52H38.89l-.79-5.17H32l-.78,5.17H23.14L30.21.24ZM35,6.28,32.89,18.8h4.3L35.09,6.28Z" fill="#1860c3"/><path class="logo-leaf" d="M20.14,15.09A14.38,14.38,0,0,0,5.76.71,14.38,14.38,0,0,0,20.14,15.09Z" fill="#ffbf6b"/><path class="logo-leaf" d="M20.14,15.09A14.38,14.38,0,0,0,5.76,29.47,14.38,14.38,0,0,0,20.14,15.09Z" fill="#ffbf6b"/><circle class="logo-dot" cx="5.76" cy="15.09" r="2.56" fill="#1860c3"/><path class="logo-leaf" d="M49.86,15.09A14.38,14.38,0,0,0,64.24,29.47,14.38,14.38,0,0,0,49.86,15.09Z" fill="#ffbf6b"/><path class="logo-leaf" d="M49.86,15.09A14.38,14.38,0,0,0,64.24.71,14.38,14.38,0,0,0,49.86,15.09Z" fill="#ffbf6b"/><circle class="logo-dot" cx="64.24" cy="15.09" r="2.56" fill="#1860c3"/></svg></a></div><div class="burger-btn"></div><div class="open-menu"><div class="open-menu-list"><a class="text-[3rem] text-[color:var(--main-color)]" href="/"> <div>Home</div></a><a class="text-[3rem] text-[color:var(--main-color)]" href="/work"><div>Work</div></a><a class="text-[3rem] text-[color:var(--main-color)]" href="/blog"><div>Blog</div></a></div></div></nav></header><main><div class="post-page"><div class="head-content my-4"><div class="flex items-center justify-between mb-4"><div class="block lg:flex lg:items-center lg:w-auto"><a href="/categories/Plugin"><div class="arrow-hover"><span>Plugin</span></div></a></div></div><h1 class="page-title" id="#postTitle">用GSAP製作網站特效（二）ScrollTrigger</h1><p class="page-subtitle">ScrollTrigger是利用滑鼠滾動來控制動畫的套件，最大的賣點之一是他可以做出pin的效果，你可以自由控制什麼時候要被pin住。</p><div class="flex items-center justify-between pt-4"><div class="block lg:flex lg:items-center lg:w-auto"><a class="mr-4" href="/tags/Animation"><div class="line-hover"><span>Animation</span></div></a></div><time datetime="2023-09-17T04:17:39.000Z">2023-09-17</time></div></div><div class="w-full"><article class="post-content"><p>ScrollTrigger是利用滑鼠滾動來控制動畫的套件，最大的賣點之一是他可以做出pin的效果，你可以自由控制什麼時候要被pin住。</p>
<p><img src="/images/post/head-cv-09.jpg" alt="$cover"></p>
<h2 id="ScrollTrigger-的基礎操作"><a href="#ScrollTrigger-的基礎操作" class="headerlink" title="ScrollTrigger 的基礎操作"></a>ScrollTrigger 的基礎操作</h2><p>ScrollTrigger是利用滑鼠滾動來控制動畫的套件，最大的賣點之一是他可以做出pin的效果，你可以自由控制什麼時候要被pin住。<br>他的原理是fixed住你想pin的區塊並且加入<code>padding-bottom</code>把下方的區塊推下去，讓使用者在感覺不出來畫面是有真實在滾動的。</p>
<h4 id="step-1-載入套件"><a href="#step-1-載入套件" class="headerlink" title="step 1. 載入套件"></a>step 1. 載入套件</h4><p>第一步你要先告訴gsap你要加載這個套件跟你要控制的物件</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">gsap.<span class="title function_">registerPlugin</span>(<span class="title class_">ScrollTrigger</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// trigger代表你想要作用的區塊(如果不寫的話會自動抓gsap.to的對象，所以也可以省略)</span></span><br><span class="line">gsap.<span class="title function_">to</span>(<span class="string">&quot;.b&quot;</span>, &#123;</span><br><span class="line">    <span class="attr">scrollTrigger</span>: &#123;</span><br><span class="line">        <span class="attr">trigger</span>: <span class="string">&quot;.b&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="step-2-設定開始跟結束的範圍-amp-動畫效果"><a href="#step-2-設定開始跟結束的範圍-amp-動畫效果" class="headerlink" title="step 2. 設定開始跟結束的範圍&amp;動畫效果"></a>step 2. 設定開始跟結束的範圍&amp;動畫效果</h4><p>第二步你要設定開始點跟結束點，如果你覺得觸發的條件有點抽象可以開啟markers檢視觸發的位置在哪裡。觸發的點是當scroller-start進入start時開始，scroller-end進入到end時結束</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">gsap.<span class="title function_">to</span>(<span class="string">&quot;.b&quot;</span>, &#123;</span><br><span class="line">    <span class="attr">x</span>: <span class="number">150</span>,</span><br><span class="line">    <span class="attr">rotation</span>: <span class="number">360</span>,</span><br><span class="line">    <span class="attr">ease</span>: <span class="string">&quot;power1.out&quot;</span>,</span><br><span class="line">    <span class="attr">scrollTrigger</span>: &#123;</span><br><span class="line">      <span class="attr">trigger</span>: <span class="string">&quot;.b&quot;</span>, <span class="comment">//觸發的物件(可省略)</span></span><br><span class="line">      <span class="attr">start</span>: <span class="string">&quot;50% 70%&quot;</span>, <span class="comment">// (物件開始位置, 卷軸開始位置) 參數可以設定 top center bottom px %</span></span><br><span class="line">      <span class="attr">end</span>: <span class="string">&quot;+=300&quot;</span>, <span class="comment">//(物件結束位置, 卷軸結束位置) , 也可以設卷軸捲動多少結束動畫(+=300是指start的位置再加上300)</span></span><br><span class="line">      <span class="attr">pin</span>: <span class="literal">true</span>, <span class="comment">// 物件執行完動畫會跟著卷軸走，類似 position: fixed</span></span><br><span class="line">      <span class="attr">scrub</span>: <span class="number">1</span>, <span class="comment">// 物件動畫延遲的秒數</span></span><br><span class="line">      <span class="attr">toggleClass</span>: <span class="string">&quot;active&quot;</span>, <span class="comment">// 增加移除的class，class名稱須為字串</span></span><br><span class="line">      <span class="attr">markers</span>: <span class="literal">true</span> <span class="comment">// 顯示標記</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<iframe src="https://codepen.io/GreenSock/embed/zYXryjN?height=300&theme-id=dark&default-tab=js,result" width="100%" height="300" frameborder="0" loading="lazy" allowfullscreen></iframe>

<h4 id="常見參數介紹"><a href="#常見參數介紹" class="headerlink" title="常見參數介紹"></a>常見參數介紹</h4><div class="table-outer">
<table>
<thead>
<tr>
<th>指令</th>
<th>型別</th>
<th>用途</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>String | Number | Function</td>
<td><ul><li>可以輸入兩個參數分別代表 [物件開始位置, 卷軸開始位置]</li><li>如果沒有輸入參數則預設為top</li><li>單位可以設定 top center bottom px % +=100 也可以是自定義變數或是函式</li><li>max是一個特殊的單位，指最大的捲動長度</li></ul></td>
</tr>
<tr>
<td>end</td>
<td>String | Number | Function</td>
<td><ul><li>可以輸入兩個參數分別代表 [物件結束位置, 卷軸結束位置]</li><li>如果沒有輸入參數則預設為bottom</li><li>單位可以設定 top center bottom px % +=100 也可以是自定義變數或是函式</li><li>max是一個特殊的單位，指最大的捲動長度</li></ul></td>
</tr>
<tr>
<td>markers</td>
<td>Boolean</td>
<td>打開位置檢查器</td>
</tr>
<tr>
<td>horizontal</td>
<td>Boolean</td>
<td>打開的話往下畫面會橫向移動(可以開啟markers發現位置由上下變成左右了)</td>
</tr>
<tr>
<td>pin</td>
<td>Boolean | Element </td>
<td>觸發時會被釘選住(fixed)，參數也可以設定你想pin的元素位置</td>
</tr>
<tr>
<td>pinSpacing</td>
<td>Boolean</td>
<td>如果不想要釘選時自動生成下方的padding，可以使用false取消掉</td>
</tr>
<tr>
<td>toggleClass</td>
<td>String</td>
<td>觸發時該物件會新增的class，class名稱須為字串(如果你想新增class的地方不是該物件就只能用onEnter的方法觸發)</td>
</tr>
<tr>
<td>toggleActions</td>
<td>String</td>
<td>需要輸入四個參數，分別代表onEnter、onLeave、onEnterBack、onLeaveBack的行爲(EX:play none none none 代表只有正向進入時會執行動畫)</td>
</tr>
<tr>
<td>scrub</td>
<td>Boolean | Number</td>
<td>如果設定true代表會按照滑鼠滾動的距離計算動畫的位置，如果設定數字則代表動畫延遲的秒數</td>
</tr>
<tr>
<td>onEnter</td>
<td>Function</td>
<td>由上往下進入時觸發函式 <code>onEnter: () => &#123;...&#125;</code></td>
</tr>
<tr>
<td>onEnterBack</td>
<td>Function</td>
<td>由下往上進入時觸發函式 <code>onEnterBack: () => &#123;...&#125;</code></td>
</tr>
<tr>
<td>onLeave</td>
<td>Function</td>
<td>由上往下離開時觸發程式 <code>onLeave: () => &#123;...&#125;</code></td>
</tr>
<tr>
<td>onLeaveBack</td>
<td>Function</td>
<td>由下往上離開時觸發函式 <code>onLeaveBack: () => &#123;...&#125;</code></td>
</tr>
</tbody>
</table>
</div>

<p>註：這些參數都必須寫在scrollTrigger裡面才會作用</p>
<p>如果覺得onEnter很抽象的話，官方也有給解釋的範例</p>
<iframe src="https://codepen.io/GreenSock/embed/qBrRaeX?height=300&theme-id=dark&default-tab=js,result" width="100%" height="300" frameborder="0" loading="lazy" allowfullscreen></iframe>

<p>更詳細的參數介紹請見<a target="_blank" rel="external nofollow noopener noreferrer" href="https://gsap.com/docs/v3/Plugins/ScrollTrigger/">官方手冊</a></p>
<hr>
<h2 id="使用timeline優化流程"><a href="#使用timeline優化流程" class="headerlink" title="使用timeline優化流程"></a>使用timeline優化流程</h2><p>上述的範例都是在物件只有一個的情況下，當你的動畫是由很多物件組合在一起的，這時使用timeline去組合這些動畫會比較好。</p>
<h4 id="step-1-設定-timeline"><a href="#step-1-設定-timeline" class="headerlink" title="step 1. 設定 timeline"></a>step 1. 設定 timeline</h4><p>首先你要先建立一個<code>gsap.timeline</code>，trigger的位置是這些物件的父層容器。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">gsap.<span class="title function_">registerPlugin</span>(<span class="string">&quot;ScrollTrigger&quot;</span>);</span><br><span class="line"></span><br><span class="line">gsap.<span class="title function_">timeline</span>(&#123;</span><br><span class="line">    <span class="attr">scrollTrigger</span>: &#123;</span><br><span class="line">        <span class="attr">trigger</span>: <span class="string">&quot;.public-section&quot;</span>, <span class="comment">// 你想要作用的區塊</span></span><br><span class="line">        <span class="attr">start</span>: <span class="string">&quot;top top&quot;</span>, <span class="comment">// 開始位置</span></span><br><span class="line">        <span class="attr">end</span>: <span class="string">&quot;+=2000&quot;</span>, <span class="comment">// 結束位置(通常會給他設定這段動畫的總長為多少)</span></span><br><span class="line">        <span class="attr">pin</span>: <span class="string">&quot;.public-section&quot;</span>, <span class="comment">// 你想要fixed的區塊</span></span><br><span class="line">    &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>看下面的範例可以發現只要放在父層容器的所有物件都會跟著被fixed住，直到滾動超過2000px後才恢復正常的效果。</p>
<iframe src="https://codepen.io/GreenSock/embed/eYoJXXq?height=300&theme-id=dark&default-tab=js,result" width="100%" height="300" frameborder="0" loading="lazy" allowfullscreen></iframe>

<h4 id="step-2-設定動畫的時間軸"><a href="#step-2-設定動畫的時間軸" class="headerlink" title="step 2. 設定動畫的時間軸"></a>step 2. 設定動畫的時間軸</h4><p>就像接龍一樣把接下來想做的動畫串連上去就可以了。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">gsap.<span class="title function_">timeline</span>(&#123;</span><br><span class="line">    <span class="attr">scrollTrigger</span>: &#123;</span><br><span class="line">        <span class="attr">trigger</span>: <span class="string">&quot;.public-section&quot;</span>,</span><br><span class="line">        <span class="attr">start</span>: <span class="string">&quot;top top&quot;</span>,</span><br><span class="line">        <span class="attr">end</span>: <span class="string">&quot;+=2000&quot;</span>,</span><br><span class="line">        <span class="attr">pin</span>: <span class="string">&quot;.public-section&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;).<span class="title function_">to</span>(</span><br><span class="line">    <span class="string">&quot;.public-section .a&quot;</span>,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">x</span>: <span class="number">300</span>,</span><br><span class="line">        <span class="attr">scrollTrigger</span>: &#123;</span><br><span class="line">          <span class="attr">start</span>: <span class="number">0</span>,</span><br><span class="line">          <span class="attr">end</span>: <span class="number">500</span>,</span><br><span class="line">          <span class="attr">scrub</span>: <span class="number">1</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">).<span class="title function_">fromTo</span>(</span><br><span class="line">    <span class="string">&quot;.public-section .b&quot;</span>,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">autoAlpha</span>: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">autoAlpha</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">y</span>: -<span class="number">300</span>,</span><br><span class="line">        <span class="attr">scrollTrigger</span>: &#123;</span><br><span class="line">          <span class="attr">start</span>: <span class="number">200</span>,</span><br><span class="line">          <span class="attr">end</span>: <span class="number">800</span>,</span><br><span class="line">          <span class="attr">scrub</span>: <span class="number">1</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<iframe src="https://codepen.io/GreenSock/embed/abxdrpG?height=300&theme-id=dark&default-tab=js,result" width="100%" height="300" frameborder="0" loading="lazy" allowfullscreen></iframe>

<hr>
<p>如果你覺得接龍的方式會讓函式變得一大串，也可以把它拆分成多段，這樣程式碼看起來就不會像一坨義大利麵。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> part1_tl = gsap.<span class="title function_">timeline</span>();</span><br><span class="line"><span class="keyword">let</span> part2_tl = gsap.<span class="title function_">timeline</span>();</span><br><span class="line"></span><br><span class="line"><span class="title class_">ScrollTrigger</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">    <span class="attr">trigger</span>: <span class="string">&quot;.public-section&quot;</span>,</span><br><span class="line">    <span class="attr">start</span>: <span class="string">&quot;top top&quot;</span>,</span><br><span class="line">    <span class="attr">end</span>: <span class="string">&quot;+=2000&quot;</span>,</span><br><span class="line">    <span class="attr">pin</span>: <span class="string">&quot;.public-section&quot;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">part1_tl.<span class="title function_">to</span>(</span><br><span class="line">    <span class="string">&quot;.public-section .a&quot;</span>,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">x</span>: <span class="number">300</span>,</span><br><span class="line">        <span class="attr">scrollTrigger</span>: &#123;</span><br><span class="line">          <span class="attr">start</span>: <span class="number">0</span>,</span><br><span class="line">          <span class="attr">end</span>: <span class="number">500</span>,</span><br><span class="line">          <span class="attr">scrub</span>: <span class="number">1</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">part2_tl.<span class="title function_">fromTo</span>(</span><br><span class="line">    <span class="string">&quot;.public-section .b&quot;</span>,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">autoAlpha</span>: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">autoAlpha</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">y</span>: -<span class="number">300</span>,</span><br><span class="line">        <span class="attr">scrollTrigger</span>: &#123;</span><br><span class="line">          <span class="attr">start</span>: <span class="number">200</span>,</span><br><span class="line">          <span class="attr">end</span>: <span class="number">800</span>,</span><br><span class="line">          <span class="attr">scrub</span>: <span class="number">1</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="案例研究"><a href="#案例研究" class="headerlink" title="案例研究"></a>案例研究</h2><p>我這邊分析幾個官方給的example，可以從中學習他們是如何運用這些參數去做動畫。</p>
<h4 id="案例一-stagger的運用"><a href="#案例一-stagger的運用" class="headerlink" title="案例一 stagger的運用"></a>案例一 stagger的運用</h4><p>stagger是用來處理多個物件時每一個物件的間距秒數</p>
<iframe src="https://codepen.io/GreenSock/embed/qBwZZgg?height=300&theme-id=dark&default-tab=js,result" width="100%" height="300" frameborder="0" loading="lazy" allowfullscreen></iframe>

<p>首先他把大砲跟射出去的東西拆成兩個timeline，再用一個masterTl去組合在一起。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> masterTl = gsap.<span class="title function_">timeline</span>(&#123;</span><br><span class="line">  <span class="attr">paused</span>: <span class="literal">true</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> tl1 = gsap.<span class="title function_">timeline</span>()</span><br><span class="line"><span class="keyword">const</span> tl2 = gsap.<span class="title function_">timeline</span>()</span><br><span class="line"></span><br><span class="line">masterTl</span><br><span class="line">  .<span class="title function_">add</span>(tl1, <span class="number">0</span>)</span><br><span class="line">  .<span class="title function_">add</span>(tl2, <span class="number">0</span>)</span><br><span class="line">  .<span class="title function_">play</span>();</span><br></pre></td></tr></table></figure>

<p>大砲的部分，他用3段動畫組合在一起，分別是往左、左右搖擺、往右，因為沒有設定scrollTrigger所以動畫會是一個執行完馬上接著做下一個。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> tl1 = gsap</span><br><span class="line">    .<span class="title function_">timeline</span>()</span><br><span class="line">    .<span class="title function_">to</span>(cannon, &#123;</span><br><span class="line">        <span class="attr">rotation</span>: -angle,</span><br><span class="line">        <span class="attr">duration</span>: <span class="number">0.65</span>,</span><br><span class="line">        <span class="attr">ease</span>: <span class="string">&quot;power1.inOut&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">to</span>(</span><br><span class="line">    cannon,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">rotation</span>: angle,</span><br><span class="line">        <span class="attr">ease</span>: <span class="string">&quot;power1.inOut&quot;</span>,</span><br><span class="line">        <span class="attr">duration</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">repeat</span>: <span class="number">3</span>,</span><br><span class="line">        <span class="attr">yoyo</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    )</span><br><span class="line">    .<span class="title function_">to</span>(cannon, &#123;</span><br><span class="line">        <span class="attr">rotation</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">duration</span>: <span class="number">0.65</span>,</span><br><span class="line">        <span class="attr">ease</span>: <span class="string">&quot;power1.inOut&quot;</span></span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>

<p>子彈的部分因為是一個一個射出去，所以你要給gsap一個array讓他知道要抓取哪些元素。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> bullets = [];</span><br><span class="line"><span class="keyword">const</span> bulletsContainer = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.flair-container&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> tl1Time = tl1.<span class="title function_">duration</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">40</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> className = <span class="string">&quot;flair--&quot;</span> + gsap.<span class="property">utils</span>.<span class="title function_">random</span>(<span class="number">2</span>, <span class="number">35</span>, <span class="number">1</span>);</span><br><span class="line">    flairBullet = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">    flairBullet.<span class="title function_">setAttribute</span>(<span class="string">&quot;class&quot;</span>, <span class="string">&quot;flair flair-bullet &quot;</span> + className);</span><br><span class="line">    bulletsContainer.<span class="title function_">appendChild</span>(flairBullet);</span><br><span class="line">    bullets.<span class="title function_">push</span>(flairBullet);</span><br><span class="line">    gsap.<span class="title function_">set</span>(flairBullet, &#123; <span class="attr">scale</span>: <span class="string">&quot;random(0.4, 0.6)&quot;</span> &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<div class="admonition info"><p class="admonition-title">tip
</p><p><code>gsap.utils()</code>是gsap提供的一些實用的方法，你不一定要用原生的JS去處理，這邊有相關的<a target="_blank" rel="external nofollow noopener noreferrer" href="https://gsap.com/docs/v3/GSAP/gsap.utils">方法介紹</a>。
所以按照文件說明 <code>gsap.utils.random(2, 35, 1)</code> 這段的意思就是隨機產生2~35的數字寫最小單位是1(也就是不會有小數點)</p>
</div>

<div class="admonition info"><p class="admonition-title">tip
</p><p><code>gsap.set()</code>是設定元素的css設定需要有兩個參數，第一個是作用的元素、第二個是css樣式，等同於沒有ease效果的gsap.to()。
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">gsap.<span class="title function_">set</span>(<span class="string">&quot;.class&quot;</span>, { <span class="attr">x</span>: <span class="number">100</span>, <span class="attr">y</span>: <span class="number">50</span>, <span class="attr">opacity</span>: <span class="number">0</span> }); <span class="comment">// 這兩個的結果會一樣</span></span><br><span class="line">gsap.<span class="title function_">to</span>(<span class="string">&quot;.class&quot;</span>, { <span class="attr">duration</span>: <span class="number">0</span>, <span class="attr">x</span>: <span class="number">100</span>, <span class="attr">y</span>: <span class="number">50</span>, <span class="attr">opacity</span>: <span class="number">0</span> });</span><br><span class="line"></span><br><span class="line">gsap.<span class="title function_">set</span>([obj1, obj2, obj3], { <span class="attr">x</span>: <span class="number">100</span>, <span class="attr">y</span>: <span class="number">50</span>, <span class="attr">opacity</span>: <span class="number">0</span> }); <span class="comment">// 第一個參數也可以為array</span></span><br></pre></td></tr></table></figure></p>
</div>

<p>最後做出 1.子彈出現 2.子彈射出 的連續動畫，這邊有用到<code>physics2D</code> 這個是需要付費的套件功能(Physics2DPlugin)，所以就不多作介紹。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> tl2 = gsap</span><br><span class="line">    .<span class="title function_">timeline</span>()</span><br><span class="line">    .<span class="title function_">to</span>(bullets, &#123;</span><br><span class="line">        <span class="attr">opacity</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">duration</span>: <span class="number">0.25</span>,</span><br><span class="line">            <span class="attr">stagger</span>: &#123;</span><br><span class="line">            <span class="attr">amount</span>: tl1Time</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">to</span>(bullets,&#123;</span><br><span class="line">        <span class="attr">duration</span>: tl1Time,</span><br><span class="line">        <span class="attr">physics2D</span>: &#123;</span><br><span class="line">            <span class="attr">velocity</span>: <span class="string">&quot;random(600, 850)&quot;</span>,</span><br><span class="line">            <span class="attr">angle</span>: <span class="function">() =&gt;</span> <span class="number">270</span> + gsap.<span class="title function_">getProperty</span>(cannon, <span class="string">&quot;rotation&quot;</span>),</span><br><span class="line">            <span class="attr">gravity</span>: <span class="number">600</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">stagger</span>: &#123;</span><br><span class="line">            <span class="attr">amount</span>: tl1Time</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,<span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<h4 id="案例二-橫向移動"><a href="#案例二-橫向移動" class="headerlink" title="案例二 橫向移動"></a>案例二 橫向移動</h4><p>當你要介紹timeline相關的內容時，橫向移動是一個非常好的呈現方式</p>
<iframe src="https://codepen.io/johnnytsai81/embed/rNbeeXr?height=300&theme-id=dark&default-tab=js,result" width="100%" height="300" frameborder="0" loading="lazy" allowfullscreen></iframe>

<p>首先你要先抓取你要橫向移動的區塊，並且計算它有多長</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> pinWrap = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.pin-wrap&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> pinWrapWidth = pinWrap.<span class="property">offsetWidth</span>; <span class="comment">// 計算長度</span></span><br><span class="line"><span class="keyword">let</span> horizontalScrollLength = pinWrapWidth - <span class="variable language_">window</span>.<span class="property">innerWidth</span>; <span class="comment">// 扣除螢幕的寬度(實際橫向移動的距離)</span></span><br></pre></td></tr></table></figure>

<p>接著使用scrollTrigger把畫面固定住並且給他需要橫向移動的長度(這邊把ease關掉估計是怕locomotive-scroll會互相干擾)</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">gsap.<span class="title function_">to</span>(<span class="string">&quot;.pin-wrap&quot;</span>, &#123;</span><br><span class="line">    <span class="attr">scrollTrigger</span>: &#123;</span><br><span class="line">        <span class="attr">scroller</span>: pageContainer, <span class="comment">//locomotive-scroll</span></span><br><span class="line">        <span class="attr">scrub</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">trigger</span>: <span class="string">&quot;#sectionPin&quot;</span>,</span><br><span class="line">        <span class="attr">pin</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">start</span>: <span class="string">&quot;top top&quot;</span>,</span><br><span class="line">        <span class="attr">end</span>: pinWrapWidth</span><br><span class="line">    &#125;,</span><br><span class="line">        <span class="attr">x</span>: -horizontalScrollLength,</span><br><span class="line">        <span class="attr">ease</span>: <span class="string">&quot;none&quot;</span></span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>

<p>最後因為他有使用locomotive-scroll的關係，所以有使用refresh()跟update()的方式防止scrollTrigger計算錯誤。</p>
<hr>
<h2 id="進階設定"><a href="#進階設定" class="headerlink" title="進階設定"></a>進階設定</h2><p>這邊舉一些我有用過的參數或是屬性，因為實在太多了無法一一列舉。</p>
<h4 id="偵測裝置行為"><a href="#偵測裝置行為" class="headerlink" title="偵測裝置行為"></a>偵測裝置行為</h4><p>有時候你會遇到手機裝置跟滑鼠裝置做出不一樣的行為時可以使用<code>ScrollTrigger.isTouch</code>這個屬性去做判斷。<br>0為滑鼠模式，1為觸碰模式，2為兩者皆是</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title class_">ScrollTrigger</span>.<span class="property">isTouch</span>) &#123;</span><br><span class="line">    <span class="comment">// 可以觸碰的裝置</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="偵測移動方向"><a href="#偵測移動方向" class="headerlink" title="偵測移動方向"></a>偵測移動方向</h4><p>當你需要判斷現在使用者是往哪裡滑動的時候，可以用<code>ScrollTrigger.observe()</code>去做偵測不需要另外使用Observer這個套件。<br>至於參數設定跟Observer一樣，會在下一篇做更詳細的介紹。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">ScrollTrigger</span>.<span class="title function_">observe</span>(&#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&quot;wheel, touch&quot;</span>, <span class="comment">// 需要作用的行為</span></span><br><span class="line">    <span class="attr">onUp</span>: <span class="function">() =&gt;</span> ..., <span class="comment">// 往上滑想要做的事情</span></span><br><span class="line">    <span class="attr">onLeft</span>: <span class="function">() =&gt;</span> ..., <span class="comment">// 往右滑想要做的事情</span></span><br><span class="line">    <span class="attr">wheelSpeed</span>: -<span class="number">1</span>, <span class="comment">// 因為用手機滑動是往下滑畫面往上跑，所以行爲要剛好相反</span></span><br><span class="line">    <span class="attr">tolerance</span>: <span class="number">50</span>, <span class="comment">// 數值越大會需要滑動較大力才會觸發</span></span><br><span class="line">    <span class="attr">preventDefault</span>: <span class="literal">true</span>, <span class="comment">// 防止預設行為</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="同時控制多個相同的動畫"><a href="#同時控制多個相同的動畫" class="headerlink" title="同時控制多個相同的動畫"></a>同時控制多個相同的動畫</h4><p>一般來說你可以用<code>ScrollTrigger.array()</code>同時控制多個物件，這邊有提供一個<code>ScrollTrigger.batch()</code>讓你更簡便處理回調函式。</p>
<iframe src="https://codepen.io/johnnytsai81/embed/GRLZrzv?height=300&theme-id=dark&default-tab=js,result" width="100%" height="300" frameborder="0" loading="lazy" allowfullscreen></iframe></article><section class="jump-container my-12"><div class="jump-container-wrap"><!-- em is empty placeholder--><a class="button left" href="/Plugin/17_gsap-3/" title="用GSAP製作網站特效（三）Observer"><span class="left-arrow"><span class="title">下一篇</span><span>用GSAP製作網站特效（三）Observer</span></span></a><a class="button right" href="/Plugin/15_gsap-1/" title="用GSAP製作網站特效（ㄧ）基礎篇"><span class="right-arrow"><span class="title">上一篇</span><span>用GSAP製作網站特效（ㄧ）基礎篇</span></span></a></div></section><article class="mt-6 comment-container"><script async repo="johnnytsai81/johnnytsai81.github.io" src="https://utteranc.es/client.js" issue-term="pathname" theme="github-light"></script></article></div></div></main><footer><div class="flex justify-center flex-col lg:flex-row py-3"><p class="mb-0 font-light lg:pr-8 text-center text-sm text-[color:var(--iron-color)]">Copyright © 2022 A Tsai,  All Rights Reserved</p><p class="mb-0 font-light lg:pr-8 text-center  text-sm text-[color:var(--iron-color)]">Designed by Anthony Tsai</p><p class="mb-0 font-light text-center  text-sm text-[color:var(--iron-color)]">Powered by Hexo</p></div></footer></body></html>