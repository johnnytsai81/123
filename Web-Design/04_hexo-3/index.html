<!DOCTYPE html><html lang="zh-TW"><head><meta charset="UTF-8"><title>用hexo打造屬於自己的部落格（三）-架構篇</title><meta name="description" content="Website / UI Designer"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/style/common/base.css"><link rel="stylesheet" href="/style/common/common.css"><link rel="stylesheet" href="/style/app.css"><script src="/jquery/jquery.min.js"></script><script src="/jquery/inview.min.js"></script><script src="/jquery/swiper/js/swiper.min.js"></script><script defer src="/js/clipboard.min.js"></script><script defer src="/js/custom.js"></script><script defer src="/js/webfont.js"></script><link rel="stylesheet" href="/style/post.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="hexo是一個可以快速建立blog的網誌框架，擁有豐富的主題、及外掛可以利用。

Hexo的運作流程
如果想要對現有的主題進行大幅度的修改，首先要先了解hexo的架構及他的運作方法，這樣才知道要從哪裡開始進行修改。一開始我們在編輯好檔案或是修改好config後，會先在終端機打上hexo g，用意是把模板語法轉譯成瀏覽器可以讀取的檔案。轉譯好的檔案會先放在public資料夾裡，你會看到裡面都是被轉譯好的html、css、js檔。


為什麼要進行轉譯的動作呢？因為我們做的網站不可能是一頁一個html手動完成的，這樣會非常的花費時間。所以模板語法可以幫助我們用拼圖的方式組合，重複的地方我們只需要做一次即可（像是header、footer等等）。轉譯好後我們可以選擇使用hexo s本機瀏覽或是hexo d推到網路.."><meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/atom.xml" title="Anthony's Blog" type="application/atom+xml">
</head><body><header><div id="loading"><img id="loading-image" src="/images/loading-logo.png" alt="Loading..."><div class="loader"></div></div><div class="loading-easein"></div><div class="loading-background"></div><nav class="hidden lg:flex items-center justify-between flex-wrap py-6 px-8"><div class="flex items-center flex-shrink-0"><a href="/"> <svg class="header-logo" alt="Logo" xmlns="http://www.w3.org/2000/svg" height="30" width="70" viewBox="0 0 70 30"><path class="logo-text" d="M39.88.24l7.19,29.52H38.89l-.79-5.17H32l-.78,5.17H23.14L30.21.24ZM35,6.28,32.89,18.8h4.3L35.09,6.28Z" fill="#1860c3"></path><path class="logo-leaf" d="M20.14,15.09A14.38,14.38,0,0,0,5.76.71,14.38,14.38,0,0,0,20.14,15.09Z" fill="#ffbf6b"></path><path class="logo-leaf" d="M20.14,15.09A14.38,14.38,0,0,0,5.76,29.47,14.38,14.38,0,0,0,20.14,15.09Z" fill="#ffbf6b"></path><circle class="logo-dot" cx="5.76" cy="15.09" r="2.56" fill="#1860c3"></circle><path class="logo-leaf" d="M49.86,15.09A14.38,14.38,0,0,0,64.24,29.47,14.38,14.38,0,0,0,49.86,15.09Z" fill="#ffbf6b"></path><path class="logo-leaf" d="M49.86,15.09A14.38,14.38,0,0,0,64.24.71,14.38,14.38,0,0,0,49.86,15.09Z" fill="#ffbf6b"></path><circle class="logo-dot" cx="64.24" cy="15.09" r="2.56" fill="#1860c3"></circle></svg></a></div><div class="block lg:flex lg:items-center lg:w-auto"><div class="lg:flex-grow"><a class="nav-title line-hover" href="/"> <span>Home</span></a><a class="nav-title line-hover" href="/work"><span>Work</span></a><a class="nav-title line-hover" href="/blog"><span>Blog</span></a></div></div></nav><nav class="relative header-widget flex-shrink-0 self-center justify-between flex py-4 px-6 lg:hidden z-50"><div class="flex items-center flex-shrink-0"><a href="/"> <svg class="header-logo" xmlns="http://www.w3.org/2000/svg" height="30" width="70" viewBox="0 0 70 30"><path class="logo-text" d="M39.88.24l7.19,29.52H38.89l-.79-5.17H32l-.78,5.17H23.14L30.21.24ZM35,6.28,32.89,18.8h4.3L35.09,6.28Z" fill="#1860c3"></path><path class="logo-leaf" d="M20.14,15.09A14.38,14.38,0,0,0,5.76.71,14.38,14.38,0,0,0,20.14,15.09Z" fill="#ffbf6b"></path><path class="logo-leaf" d="M20.14,15.09A14.38,14.38,0,0,0,5.76,29.47,14.38,14.38,0,0,0,20.14,15.09Z" fill="#ffbf6b"></path><circle class="logo-dot" cx="5.76" cy="15.09" r="2.56" fill="#1860c3"></circle><path class="logo-leaf" d="M49.86,15.09A14.38,14.38,0,0,0,64.24,29.47,14.38,14.38,0,0,0,49.86,15.09Z" fill="#ffbf6b"></path><path class="logo-leaf" d="M49.86,15.09A14.38,14.38,0,0,0,64.24.71,14.38,14.38,0,0,0,49.86,15.09Z" fill="#ffbf6b"></path><circle class="logo-dot" cx="64.24" cy="15.09" r="2.56" fill="#1860c3"></circle></svg></a></div><div class="burger-btn"></div><div class="open-menu"><div class="open-menu-list"><a class="text-[3rem] text-[color:var(--main-color)]" href="/"> <div>Home</div></a><a class="text-[3rem] text-[color:var(--main-color)]" href="/work"><div>Work</div></a><a class="text-[3rem] text-[color:var(--main-color)]" href="/blog"><div>Blog</div></a></div></div></nav></header><main><div class="post-page"><div class="head-content my-4"><div class="flex items-center justify-between mb-4"><div class="block lg:flex lg:items-center lg:w-auto"><a href="/categories/Web-Design"><div class="arrow-hover"><span>Web-Design</span></div></a></div></div><h1 class="page-title" id="#postTitle">用hexo打造屬於自己的部落格（三）-架構篇</h1><p class="page-subtitle">hexo是一個可以快速建立blog的網誌框架，擁有豐富的主題、及外掛可以利用。</p><div class="flex items-center justify-between pt-4"><div class="block lg:flex lg:items-center lg:w-auto"><a class="mr-4" href="/tags/Blog"><div class="line-hover"><span>Blog</span></div></a><a class="mr-4" href="/tags/Hexo"><div class="line-hover"><span>Hexo</span></div></a></div><time datetime="2022-04-25T04:17:39.000Z">2022-04-25</time></div></div><div class="w-full"><article class="post-content"><p>hexo是一個可以快速建立blog的網誌框架，擁有豐富的主題、及外掛可以利用。</p>
<p><img src="/images/post/head-cv-02.jpg" alt="$cover"></p>
<h3 id="Hexo的運作流程"><a href="#Hexo的運作流程" class="headerlink" title="Hexo的運作流程"></a>Hexo的運作流程</h3><blockquote>
<p>如果想要對現有的主題進行大幅度的修改，首先要先了解hexo的架構及他的運作方法，這樣才知道要從哪裡開始進行修改。一開始我們在編輯好檔案或是修改好config後，會先在終端機打上<code>hexo g</code>，用意是把模板語法轉譯成瀏覽器可以讀取的檔案。轉譯好的檔案會先放在public資料夾裡，你會看到裡面都是被轉譯好的html、css、js檔。</p>
</blockquote>
<blockquote>
<p>為什麼要進行轉譯的動作呢？因為我們做的網站不可能是一頁一個html手動完成的，這樣會非常的花費時間。所以模板語法可以幫助我們用拼圖的方式組合，重複的地方我們只需要做一次即可（像是header、footer等等）。轉譯好後我們可以選擇使用<code>hexo s</code>本機瀏覽或是<code>hexo d</code>推到網路上，推到網路上前他會進行一次的備份並放在deploy資料夾，所以你會發現到public的資料夾內容跟deploy資料夾一樣。</p>
</blockquote>
<p><img src="https://images2.imgbox.com/d7/2f/qon0Yw8A_o.jpg"><br><em>三個指令分別運作的區域</em></p>
<div class="admonition info"><p class="admonition-title">tip
</p><p>一般來說我們會修改的地方有兩個，編輯架構或樣式請到<code>themes/layout</code>及<code>themes/source</code>，編輯文章內容請到<code>source/_posts</code>。</p>
</div>

<p>這邊整理了一些比較重要的資料夾或檔案：</p>
<div class="table-outer">
<table>
<thead>
<tr>
<th>位置</th>
<th>用途</th>
</tr>
</thead>
<tbody><tr>
<td>themes</td>
<td>用來放你的主題，點進去可以看到有主題名稱的資料夾</td>
</tr>
<tr>
<td>themes/layout</td>
<td>用來放主題的網頁架構，每個主題用語法都不一樣，但最後輸出到public都會變成HTML檔</td>
</tr>
<tr>
<td>themes/source</td>
<td>用來放網站的圖片、css(hexo也有支援sass轉譯)、js</td>
</tr>
<tr>
<td>themes/languages</td>
<td>可因應所在地區改變指定文字的語言</td>
</tr>
<tr>
<td>themes/config.yml</td>
<td>主題的設定（header類別項目、留言區、其他套件等等...）</td>
</tr>
<tr>
<td>themes/package.json</td>
<td>會紀錄目前主題的版本及有用的hexo套件</td>
</tr>
<tr>
<td>source</td>
<td>放置blog文章及自訂頁的地方（需要按照網址位置去做資料夾分類，ex:你想新增網址為/sitemap的自訂頁，那你就要新增sitemap資料夾裡面放index.md）</td>
</tr>
<tr>
<td>public</td>
<td>放置轉譯過的檔案，也可以轉譯後修改再deploy，但小心若使用`hexo clean`會把修改的東西清掉（`hexo g`只會把重複的檔案覆蓋掉，並不會清除沒重複的檔案）</td>
</tr>
<tr>
<td>node_modules</td>
<td>使用npm安裝的套件內容</td>
</tr>
<tr>
<td>package.json</td>
<td>紀錄hexo目前的版本及裝過的套件</td>
</tr>
<tr>
<td>deploy</td>
<td>部署的到網路的檔案</td>
</tr>
</tbody>
</table>
</div>

<h3 id="修改網頁的首頁"><a href="#修改網頁的首頁" class="headerlink" title="修改網頁的首頁"></a>修改網頁的首頁</h3><blockquote>
<p>有時候我們想要新增一些自訂頁面，也就是不需要模板語言轉譯。如果首頁要變成自訂頁會比較麻煩些，因為要改一下config.yml的設定。點開config有一個Home page setting可以修改首頁的網址，這邊我修改成<code>/blog/</code>。這麼一來原本點開的首頁網址就會變成xxx.github.io&#x2F;blog，這樣我就可以放我的自訂頁在xxx.github.io。</p>
</blockquote>
<p><img src="https://images2.imgbox.com/15/c9/tIzjR09u_o.png"></p>
<p>至於其他自訂頁就比較簡單了，只要在source新增一個資料夾裡面放index.md即可。例如我想要新增一個&#x2F;work的自訂頁，用hexo新增一個新的page即可。</p>
<h4 id="新增自訂頁"><a href="#新增自訂頁" class="headerlink" title="新增自訂頁"></a>新增自訂頁</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new page work</span><br></pre></td></tr></table></figure>

<p><img src="https://images2.imgbox.com/4b/5b/yYpxfDCe_o.png"><br><em>如果不想要打指令碼也可以用手動新增</em></p>
<div class="admonition info"><p class="admonition-title">tip
</p><p>在製作自訂頁的時候可以先用html編輯再複製過去，因為md可以兼容html（md無法收合在編輯上比較不方便）。</p>
</div>

<hr>
<h3 id="layout與模板引擎"><a href="#layout與模板引擎" class="headerlink" title="layout與模板引擎"></a>layout與模板引擎</h3><p>網頁的架構主要都會放在themes&#x2F;你的主題&#x2F;layout裡面，每個主題所使用的模板引擎都不同，主流的有<a target="_blank" rel="noopener" href="https://ejs.bootcss.com/">EJS</a> 、<a target="_blank" rel="noopener" href="https://pugjs.org/api/getting-started.html">Pug</a> 、 <a href="'https://haml.info/'">haml</a>等。每一個模板引擎的語法都不太相同，所以選一個自己熟悉的即可，我個人是使用Pug。</p>
<p>layout的模板命名基本上會跟<a target="_blank" rel="noopener" href="https://hexo.io/zh-tw/docs/variables">hexo的變數名稱</a>有所相關，僅供參考（不確定是否主題都會遵照此名稱）</p>
<div class="table-outer">
<table>
<thead>
<tr>
<th>名稱</th>
<th>可能的用途</th>
</tr>
</thead>
<tbody><tr>
<td>index</td>
<td>首頁，也就是文章列表頁</td>
</tr>
<tr>
<td>category</td>
<td>分類頁，一個post可以有多個category</td>
</tr>
<tr>
<td>tag</td>
<td>標籤頁，一個post可以有多個tag</td>
</tr>
<tr>
<td>archive</td>
<td>匯整頁，有點類似年代表的方式紀錄文章更新歷程</td>
</tr>
<tr>
<td>page</td>
<td>自訂頁</td>
</tr>
<tr>
<td>post</td>
<td>文章</td>
</tr>
<tr>
<td>base</td>
<td>主體架構，包含了header跟footer（有些主題可能會拆開來寫）</td>
</tr>
<tr>
<td>search</td>
<td>搜尋</td>
</tr>
</tbody>
</table>
</div>

<p>除了熟悉layout的檔名對應的頁面跟功能後，還要了解模板引擎的插入概念，這樣就可以快速找到修改頁面的位置。<a href="/Web-Design/06_pug-1/">這邊</a>有詳細的介紹。</p>
<hr>
<h3 id="hexo的變數"><a href="#hexo的變數" class="headerlink" title="hexo的變數"></a>hexo的變數</h3><p>一般來說只有修改位置的話基本上不需要動到變數。但如果想要在既有的頁面新增數據或者新增功能頁，就必須靠變數來達成。因為hexo的操作手冊是使用EJS，所以你直接複製貼上在pug會沒有任何作用 🫠 🫠 🫠</p>
<p>首先我們必須要改成pug能解讀的格式，以官方手冊<a target="_blank" rel="noopener" href="https://hexo.io/docs/helpers">helper</a>來舉例（這一頁有提供很多實用的變數，或是預設架構修改），往下拉會看到一個Date&amp;Time，他可以顯示現在的時間。</p>
<p><img src="https://images2.imgbox.com/83/cb/bHaMS1Zj_o.png"></p>
<h4 id="在pug變數的寫法"><a href="#在pug變數的寫法" class="headerlink" title="在pug變數的寫法"></a>在pug變數的寫法</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 寫法一</span><br><span class="line">div= date(Date.now())</span><br><span class="line"></span><br><span class="line">// 寫法二 </span><br><span class="line">div #&#123;date(Date.now())&#125;</span><br><span class="line"></span><br><span class="line">//寫法三</span><br><span class="line">div= `$&#123;date(Date.now())&#125;`</span><br></pre></td></tr></table></figure>

<div class="admonition info"><p class="admonition-title">tip
</p><p><code>=</code> 在pug代表必須被轉譯成javaScript，如果沒有加上 <code>=</code> pug就會以為是純文字。</p>
</div>

<p>除了helper，官方手冊也有提供<a target="_blank" rel="noopener" href="https://hexo.io/zh-tw/docs/variables">變數</a>提供我們使用，用法跟helper一樣。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">div= `$&#123;page.category&#125;`</span><br></pre></td></tr></table></figure>
<p>hexo實用的變數都在page，但是page的缺點是他不是全域變數，在非page的頁面會取得不到變數資料，所以有些資料還是要靠site的全域變數去挖資料出來，首先我們先用指令查看目錄的全域資料。</p>
<h4 id="尋找變數資料"><a href="#尋找變數資料" class="headerlink" title="尋找變數資料"></a>尋找變數資料</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">each i in site.categories.data</span><br><span class="line">    = console.log(i) //顯示在終端機上</span><br></pre></td></tr></table></figure>

<p>只要在想看的變數內容後面加上data就可以看到完整的JSON資料，我的網站出現的結果是長這樣，因為我的分類有兩個所以JSON會給我兩筆資料，裡面的資料如下。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">_Document &#123;</span><br><span class="line">name: &#x27;Web-Design&#x27;,</span><br><span class="line">_id: &#x27;cl2o9jmyk0004qs971etuaglz&#x27;,</span><br><span class="line">slug: [Getter],</span><br><span class="line">path: [Getter],</span><br><span class="line">permalink: [Getter],</span><br><span class="line">posts: [Getter],</span><br><span class="line">length: [Getter]</span><br><span class="line">&#125;,</span><br><span class="line">_Document &#123;</span><br><span class="line">name: &#x27;UI-Design&#x27;,</span><br><span class="line">_id: &#x27;cl2o9jmyr000nqs97fpm466hi&#x27;,</span><br><span class="line">slug: [Getter],</span><br><span class="line">path: [Getter],</span><br><span class="line">permalink: [Getter],</span><br><span class="line">posts: [Getter],</span><br><span class="line">length: [Getter]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>有些資料是無法直接看到的，如果要取得資料，必須更深入的取得下一層的資料。我在後面加上length看每個目錄裡的數量。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">each i in site.categories.data</span><br><span class="line">    = console.log(i.length) //顯示在終端機上</span><br></pre></td></tr></table></figure>

<p>結果表示我的第一個分類的數目有10個第二個分類的數目有5個。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">10</span><br><span class="line">5</span><br></pre></td></tr></table></figure>

<p>之後再用判斷式去篩選我要的資料即可，例如我要取得該目錄的post數量，就可以過濾掉其他目錄的post數量。</p>
<h4 id="加入判斷式"><a href="#加入判斷式" class="headerlink" title="加入判斷式"></a>加入判斷式</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">each i in site.categories.data</span><br><span class="line">    if i.name === page.category</span><br><span class="line">        span= i.length</span><br></pre></td></tr></table></figure>

<hr>
<p>hexo的介紹就到這裡告一段落，如果未來有更深入的研究再上來跟大家分享，總之建立一個屬於自己的blog真的要踩很多坑呀 😩 😩 😩</p>
</article><section class="jump-container my-12"><div class="jump-container-wrap"><!-- em is empty placeholder--><a class="button left" href="/Web-Design/06_pug-1/" title="Pug 模板繼承功能(Inheritance) block extends include 介紹及應用"><span class="left-arrow"><span class="title">下一篇</span><span>Pug 模板繼承功能(Inheritance) block extends include 介紹及應用</span></span></a><a class="button right" href="/Web-Design/03_hexo-2/" title="用hexo打造屬於自己的部落格（二）-主題篇"><span class="right-arrow"><span class="title">上一篇</span><span>用hexo打造屬於自己的部落格（二）-主題篇</span></span></a></div></section><article class="mt-6 comment-container"><script async repo="johnnytsai81/johnnytsai81.github.io" src="https://utteranc.es/client.js" issue-term="pathname" theme="github-light"></script></article></div></div></main><footer><div class="flex justify-center flex-col lg:flex-row py-3"><p class="mb-0 font-light lg:pr-8 text-center text-sm text-[color:var(--iron-color)]">Copyright © 2022 A Tsai,  All Rights Reserved</p><p class="mb-0 font-light lg:pr-8 text-center  text-sm text-[color:var(--iron-color)]">Designed by Anthony Tsai</p><p class="mb-0 font-light text-center  text-sm text-[color:var(--iron-color)]">Powered by Hexo</p></div></footer></body></html>